window.Chatbot=(function(){const box=document.getElementById('chat'),btn=document.getElementById('chat-btn'),body=document.querySelector('#chat .b'),suggests=document.querySelector('#chat .s'),input=document.querySelector('#chat input'),send=document.querySelector('#chat .send');function add(t,w){const d=document.createElement('div');d.className='m '+w;d.innerHTML=t;body.appendChild(d);body.scrollTop=body.scrollHeight}function reply(t){add(t,'bot');updateS()}function you(t){add(t,'you')}const intents=[{rx:/especial|asesor|human/i,run:()=>reply('Tomo tus datos y te conecto con un especialista. También puedo abrir la cotización breve.')},{rx:/cota|precio|quote/i,run:()=>openQuote()},{rx:/soluci|proyec|solutions?/i,run:()=>reply('Te muestro las <a href="./pages/soluciones.html">Soluciones</a>. Dime tu objetivo y te sugiero una.')},{rx:/hola|hello|buenas/i,run:()=>reply(window.__T?.chatbot_intro||'Hola, soy WoMi.')}] ;function sendMsg(){const t=input.value.trim();if(!t)return;you(t);input.value='';const it=intents.find(i=>i.rx.test(t));if(it)it.run();else reply('Puedo derivarte con un especialista o preparar una cotización orientada. ¿Qué prefieres?')}function updateS(){suggests.innerHTML='';const s1=document.createElement('button');s1.textContent=window.__T?.chatbot_s1||'Hablar con un especialista';s1.onclick=()=>openQuote();const s2=document.createElement('button');s2.textContent=window.__T?.chatbot_s2||'Pedir cotización';s2.onclick=()=>openQuote();const s3=document.createElement('button');s3.textContent=window.__T?.chatbot_s3||'Ver soluciones';s3.onclick=()=>location.href='./pages/soluciones.html';suggests.append(s1,s2,s3)}btn.addEventListener('click',()=>{box.style.display=(box.style.display==='flex'?'none':'flex');if(body.children.length===0){reply(window.__T?.chatbot_intro||'Hola, soy WoMi.')}});send.addEventListener('click',sendMsg);input.addEventListener('keydown',e=>{if(e.key==='Enter')send.click()});return{updateS}})();